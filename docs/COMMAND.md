# COMMAND — Discord便利Bot v0.2

> これはユーザー向けの早見表。仕様の優先順位は SPEC.md が最上位。

## /help
コマンドの使い方を一覧・詳細で確認できます（本人のみ表示）。

### 使い方
- `/help`

### 動作
- 一覧（ナンバリング + 軽い説明）を表示し、番号ボタンで詳細へ移動できます。
- 一覧はページ送り（◀/▶）ができます。
- 詳細画面には戻る（Back）ボタンがあり、直前の一覧ページに戻れます。
- すべて原則 ephemeral（呼び出した人だけに表示）です。

---

## /bosyu
参加者募集を作成します。ボタンで参加/参加取消/締切、残り人数の調整ができます。

### 使い方
- `/bosyu`（引数なし：モーダルで入力して作成）
- `/bosyu slots:<number> title:<string> body:<string>`（引数で即時作成）

### パラメータ
- `slots`：作成者以外に「あと何人参加できるか」
- `title`：募集のタイトル
- `body`：募集内容（改行可）

### 操作（ボタン）
- `参加`：参加します（満員・参加済みは変化なし）
- `参加取消`：参加を取り消します（未参加は変化なし）
- `締切`：募集を締め切ります（作成者のみ）
- `再開`：募集を再開します（作成者のみ）
- `＋ / －`：残り人数を増減します（作成者のみ）
- `編集`：タイトル/本文/人数を編集します（作成者のみ、v0.1.2）

### 表示
- 参加者リスト：メンションで表示
- 募集人数：`あと{N}名` 形式
- 締切中は参加系ボタンが無効になります

### 注意
- `slots/title/body` を一部だけ指定した場合はエラーになります（no-op：何も投稿されません）。

---

## /bosyu-bpsr
BPSR特化のロール別募集を作成します。タンク/アタッカー/ヒーラーそれぞれに人数制限を設定できます。

### 使い方
- `/bosyu-bpsr`（モーダルで入力して作成）

### モーダル入力
- `タイトル`：募集のタイトル
- `内容`：募集内容・備考
- `🛡️タンク人数`：タンク枠数
- `⚔️アタッカー人数`：アタッカー枠数
- `💚ヒーラー人数`：ヒーラー枠数

### 操作（ボタン）
- `🛡️タンク`：タンクとして参加（空きがある場合のみ）
- `⚔️アタッカー`：アタッカーとして参加（空きがある場合のみ）
- `💚ヒーラー`：ヒーラーとして参加（空きがある場合のみ）
- `参加取消`：参加を取り消します
- `締切/再開`：募集の開閉（作成者のみ）
- `編集`：タイトル/内容/各ロール人数を編集（作成者のみ）

### 表示
- 各フィールド名：`🛡️タンク（参加者数/枠数）` 形式
- 締切中は参加系ボタンが無効になります

### 特徴
- 投稿者は自動参加せず、自分もボタンで参加します
- 既に参加済みの場合、別ロールのボタンを押すとロール変更になります
- 各ロールで定員に達すると参加できなくなります

---

## /remind
リマインダーを登録します。指定時刻にDMで通知されます。

### 使い方
- `/remind`（モーダルで入力）

### モーダル入力
- `通知時間`：通知したい時刻（例: `1400`、コロン省略可・全角OK）
- `何分前`：何分前に通知するか（空欄で0＝ちょうど通知）
- `通知内容`：通知時に表示するメッセージ

---

## /remind-list
自分のリマインダー一覧を表示・削除できます。

### 使い方
- `/remind-list`

---

## /dice
ダイスロール。指定した形式でダイスを振ります。

### 使い方
- `/dice` — 1d6（6面ダイス1回）
- `/dice expression:2d6` — 6面ダイスを2回振って合計
- `/dice expression:1d100` — 100面ダイス1回

### パラメータ
- `expression`：NdM形式（N=個数, M=面数）。省略時は `1d6`

### 出力例
```
🎲 @User rolled 2d6
Result: 3 + 5 = 8
```

---

## /allow（オーナー専用）
Bot利用許可を管理します。サーバー/ユーザー/ロール単位で許可を設定できます。

### 使い方
- `/allow guild add` — このサーバーを許可リストに追加
- `/allow guild remove` — このサーバーを許可リストから削除
- `/allow user add <command> <user>` — ユーザーにコマンド権限を付与
- `/allow user remove <command> <user>` — ユーザーからコマンド権限を削除
- `/allow role add <command> <role>` — ロールにコマンド権限を付与
- `/allow role remove <command> <role>` — ロールからコマンド権限を削除

### 注意
- **Botオーナーのみ**実行可能です（.envのOWNER_ID）
- サーバーが許可されていないと、大半のコマンドは実行できません

---

## /config（オーナー専用）
Bot設定を表示・管理します。

### 使い方
- `/config show` — 現在の設定を表示
- `/config permissions` — 全コマンドの権限設定一覧を表示
- `/config permissions command:<コマンド名>` — 特定コマンドの許可ユーザー/ロールを表示

### 表示内容
- Botオーナー
- 現在のサーバーの許可状態
- 許可済みサーバー数
- コマンド別の権限設定

### 注意
- **Botオーナーのみ**実行可能です
---

## /verify
合言葉認証システムを設置します。お知らせに隠した合言葉を入力するとロールが付与されます。

### 使い方
- `/verify keyword:<文言> role:<ロール>` — 認証ボタンを設置

### パラメータ
- `keyword`：正解の合言葉（必須）
- `role`：認証成功時に付与するロール（必須・選択式）
- `title`：埋め込みのタイトル（任意）
- `description`：説明文（任意）

### ボタン操作
- `✅ 認証する`：誰でも（モーダルで合言葉入力）
- `⚙️ 編集`：作成者/許可ユーザーのみ
- `🗑️ 削除`：作成者/許可ユーザーのみ

### 権限
- **Botオーナー** または `/allow` で許可されたユーザー/ロールのみ

---

## /bpsr-role
ロール付与ボタンを設置します。タンク/アタッカー/ヒーラーから選択し、排他的にロールを付与します。

### 使い方
- `/bpsr-role tank:<ロール> attacker:<ロール> healer:<ロール>`

### パラメータ
- `tank`：タンクボタンで付与するロール（必須）
- `attacker`：アタッカーボタンで付与するロール（必須）
- `healer`：ヒーラーボタンで付与するロール（必須）
- `title`：タイトル（任意）
- `body`：説明文（任意）

### ボタン操作
- `🛡️タンク`：タンクロールを付与/解除
- `⚔️アタッカー`：アタッカーロールを付与/解除
- `💚ヒーラー`：ヒーラーロールを付与/解除

### 動作
- **排他**：1つのロールのみ保持可能。別ボタンを押すと自動切替
- **トグル**：同じボタンを押すと解除

### 権限
- **Botオーナー** または `/allow` で許可されたユーザー/ロールのみ設置可能
- ボタン操作は**全員**が実行可能

---

## /mention-reactors
リアクションを押した人全員にメンションを送ります。

### 使い方
- `/mention-reactors message:<メッセージIDまたはリンク>`

### パラメータ
- `message`：対象メッセージのIDまたはリンク（必須）

### ボタン操作
- `[絵文字 N人]`：特定のリアクションを押した人にメンション
- `[📋 全員]`：すべてのリアクションを押した人にメンション（重複排除）

### 権限
- **Botオーナー** または `/allow` で許可されたユーザー/ロールのみ
